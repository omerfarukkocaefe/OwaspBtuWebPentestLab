<?php
require('../../database/db.php');

if ($_SERVER['REQUEST_METHOD'] == 'POST') {
    $name = mysqli_real_escape_string($conn, $_POST['sender_name']);
    $comment = mysqli_real_escape_string($conn, $_POST['sender_comment']);
  
    if (!empty($name) && !empty($comment)) {
      // Prepare statement to prevent SQL injection
      $stmt = $conn->prepare("INSERT INTO comments (sender_name, sender_comment) VALUES (?, ?)");
      $stmt->bind_param("ss", $name, $comment); // Bind parameters for safe insertion
  
      $stmt->close(); // Close the prepared statement
    }
  }
?>

<!DOCTYPE html>
<html>


<head>
    <meta charset=utf-8 />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <title> PC </title>
    <link rel="stylesheet" type="text/css" href="../../Styles/style.css" />
    <link rel="stylesheet" type="text/css" href="../../Styles/style_product.css" />
    <link rel="stylesheet" href="../../Styles/bootstrap.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js" integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+" crossorigin="anonymous"></script>
</head>

<body>
    <script src="../../Js/bootstrap.js"></script>
    <main>
    <?php require("../../header/header3.php") ?>
            
<div class="col mt-2 mb-2">
    <div class="d-flex flex-column-reverse align-items-center">
        <div class="mainText px-2">
            
            <div>
                <button onclick="window.location.href='../logout_zafiyetsiz.php'" class="log_out">Log Out</button>
            </div>

            <main class="container">
                
                <!-- Left Column / Headphones Image -->
                <div class="left-column">
                <img data-image="black" src="images/black.png" alt="">
                <img data-image="blue" src="images/blue.png" alt="">
                <img data-image="red" class="active" src="images/red.png" alt="">
                </div>


                <!-- Right Column -->
                <div class="right-column">

                <!-- Product Description -->
                <div class="product-description">
                    <span>PC</span>
                    <h1>Model 1</h1>
                    <p>The preferred choice of a vast range of acclaimed DJs. Punchy, bass-focused sound and high isolation. Sturdy headband and on-ear cushions suitable for live performance</p>
                </div>

                <!-- Product Configuration -->
                <div class="product-configuration">

                    <!-- Product Color -->
                    <div class="product-color">
                    <span>Color</span>

                    <div class="color-choose">
                        <div>
                        <input data-image="red" type="radio" id="red" name="color" value="red" checked>
                        <label for="red"><span></span></label>
                        </div>
                        <div>
                        <input data-image="blue" type="radio" id="blue" name="color" value="blue">
                        <label for="blue"><span></span></label>
                        </div>
                        <div>
                        <input data-image="black" type="radio" id="black" name="color" value="black">
                        <label for="black"><span></span></label>
                        </div>
                    </div>

                    </div>

                    <!-- Cable Configuration -->
                    <div class="cable-config">
                    <span>Cable configuration</span>

                    <div class="cable-choose">
                        <button>Straight</button>
                        <button>Coiled</button>
                        <button>Long-coiled</button>
                    </div>

                    <a href="#">How to configurate your PCs</a>
                    </div>
                </div>

                <!-- Product Pricing -->
                <div class="product-price">
                    <span><p>$2998 <del>$3999</del></p></span>
                    <a href="#" class="cart-btn">Add to cart</a>
                </div>
                </div>

                <div>
                    <img src="../../assests/images/PC.jpg" alt=""> 
                </div>
                
                <form action="product1.php" method="POST">
                    <textarea class="comment" id="comment1" name="sender_name"> Type your name here.</textarea></br>
                    <textarea class="comment" id="comment2" name="sender_comment"> Type your comment here.</textarea></br>       
                    <button class="comment_button" type="submit">post comment</button></br> </br> </br> </br>   
                </form>
                
                <div class="comment_section">
                    <h2>Yorumlar</h2>
                    <?php
                    //$stmt = $conn->query("SELECT sender_name, sender_comment FROM comments");
                    //$comments = $stmt->fetchAll();
                    
                    $sql = "SELECT sender_name, sender_comment FROM comments";
                    $comments = mysqli_query($conn, $sql);
                    
                    foreach ($comments as $comment) {
                        echo "<div class='comment_block'>";
                        echo "<h3>" . htmlspecialchars($comment['sender_name']) . "</h3>";
                        echo "<p>" . htmlspecialchars($comment['sender_comment']) . "</p>";
                        echo "</div>";
                    }

                    $conn->close();

                    ?>
                </div>

            </main>
        </div>
    </div>
</div>

        <footer class="page-bottom">
            <div>
                <button class="primary" onclick="window.dialog.showModal();">Show Hint</button>

                <dialog id="dialog" class="dialog">
                    <h2>Walkthrough</h2>
                    <h4>Steps</h4>
                    <li>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus efficitur faucibus nisi. Mauris quis velit a eros dignissim accumsan. Fusce auctor ex est, sed ultricies urna feugiat vitae. Sed magna risus, facilisis ac turpis in, semper pharetra neque. Nam a ante accumsan nisl vehicula feugiat. Nam nisi neque, mattis eu tellus quis, facilisis porttitor metus. Quisque tempus tempor massa, vitae tincidunt elit tristique ac. Donec molestie sapien et quam mollis, vel gravida massa laoreet. Aliquam at felis volutpat, auctor tellus a, dignissim mauris. Sed convallis eros sit amet lorem auctor, id tincidunt nulla auctor</li>
                    <li>123</li>
                    <li>123</li>
                    <p><a href="#">Tutorial Video</a></p>
                    <button onclick="window.dialog.close();" aria-label="close" class="x">‚ùå</button>
                </dialog>
            </div>
        </footer>


</main>
    
</body>

</html>


